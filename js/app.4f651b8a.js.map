{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?c650","webpack:///./src/views/Streamer.vue?3ef6","webpack:///./src/components/GSButton.vue?e1ab","webpack:///./src/plugins/GMMKPlugin.ts","webpack:///./src/App.vue?96d1","webpack:///./src/App.vue","webpack:///./src/registerServiceWorker.ts","webpack:///./src/views/Streamer.vue?cc6c","webpack:///./src/lib/utils.ts","webpack:///./src/assets/keymap-DE-ISO-fullsize.txt","webpack:///./src/lib/libMap.ts","webpack:///./src/lib/libGL.ts","webpack:///./src/components/GSButton.vue?3aa9","webpack:///./src/components/GSButton.vue","webpack:///./src/components/GSButton.vue?554c","webpack:///./src/components/GSButton.vue?38d0","webpack:///./src/shaders/blur.frag","webpack:///./src/shaders/blur.vert","webpack:///./src/views/Streamer.vue","webpack:///./src/views/Streamer.vue?ce6d","webpack:///./src/views/Streamer.vue?18cb","webpack:///./src/router/index.ts","webpack:///./src/store/index.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","GMMK_CMD_START","GMMK_CMD_END","GMMK_CMD_KEYCOLORS","GMMK_CMD_SUBCOMMAND","GMMK_SUBCMD_CMD_OFFSET","GMMK_SUBCMD_ARG_OFFSET","GMMK_PACKET_SIZE","GMMK_COMMAND_OFFSET","GMMK_MAX_KEY","GMMK_SUM_OFFSET","GMMK_KEYCOLORS_COUNT_OFFSET","GMMK_KEYCOLORS_START_OFFSET","GMMK_KEYCOLORS_DATA_OFFSET","GMMK_KEYCOLORS_DATA_SIZE","Math","floor","fillSingleColor","color","min","max","Array","fill","dataSetProfile","this","WebHID","navigator","hid","HIDAvailable","initialized","buffer","Uint8Array","colors","g","b","selectedDevice","requestDevice","filters","vendorId","productId","usagePage","devices","console","log","initializeKeyboard","opened","open","setProfile","setCustomMode","setRate","setDelay","setKeys","setMode","resetBuffer","startCommand","write","endCommand","profile","message","delay","rate","start","count","bytesRemaining","bytesToBeSent","keysToBeSent","offset","sum","reduce","acc","e","sendReport","GMMKPlugin","Vue","$gmmkInterface","_vm","_h","$createElement","_c","_self","attrs","staticRenderFns","script","component","ready","registered","cached","updatefound","updated","offline","error","staticClass","class","showPreview","_v","_m","hasWebHIDSupport","_e","on","selectHIDDevice","scopedSlots","_u","fn","proxy","sourceSelectButtonDisabled","selectDesktopSource","stopStream","toggleKeyboardPreview","ref","_l","keyMatrix","flat","style","keyStyles","keyIndex","_s","label","gcd","a","lcm","abs","minMultF2I","num","nstr","toString","ndecimal","split","fractionDenominator","array","deduped","el","includes","linspace","step","map","gaussian","x","mu","sigma","sqrt","PI","exp","descriptor","kbdName","keyboard","keyboards","layouts","layout_names","keys","layout","layers","qmkLayout","yValues","y","qmkMatrix","y_index","filter","x_index","elements","row","element","index_rows","kbdMap","mapWidth","mapHeight","parseInt","shape","gmmk_keymap","qmk_layout","combinedMatrix","combined_row","qmkElement","qmkMapperExists","key_x","key_y","key_w","w","key_h","h","center","keyInfo","tmpMap","min_x","max_x","min_y","max_y","bitmap_scl_x","bitmap_scl_y","kbdBitmapSize","boundingBox","width","height","createShader","gl","source","type","shaderType","FRAGMENT_SHADER","VERTEX_SHADER","shader","shaderSource","compileShader","compileMsg","getShaderInfoLog","createTexture","size","texture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","texImage2D","RGBA","offsetWidth","offsetHeight","UNSIGNED_BYTE","disabled","onClick","_t","text","extend","props","String","default","Boolean","methods","$emit","desktopMediaStream","glInitialized","shaderProgram","canvasResolution","isStreaming","pixelBuffer","keyboardInitialized","displayStreamStarted","showKeyPreview","canvasSize","components","KeyboardIcon","GSButton","DisplayShareIcon","ShowKeyboardPreviewIcon","StopIcon","Stop","mounted","maps","addEventListener","resizeListener","computed","Map","capSize","position","left","top","connectDevice","mediaDevices","getDisplayMedia","audio","video","screen","videoPreview","$refs","srcObject","onloadedmetadata","play","setTimeout","initStreamer","getVideoTracks","init_webGL","webgl_process_frame","canvas","previewCanvas","getContext","preserveDrawingBuffer","vertexShader","fragmentShader","createProgram","attachShader","linkProgram","vertexArray","Float32Array","uv","indices","nIndices","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","UVBuffer","IndexBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","videoTexture","useProgram","vertexBufferCoord","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","uvBufferCoord","uniform1i","getUniformLocation","activeTexture","TEXTURE0","uniform2f","kernelSize","kernel","uniform1fv","clearColor","clear","COLOR_BUFFER_BIT","viewport","drawElements","TRIANGLES","UNSIGNED_SHORT","flush","download_image","drawingBufferWidth","drawingBufferHeight","readPixels","keyColors","sy","sx","canvasWidth","canvasHeight","stepX","stepY","px","py","idx","getTracks","forEach","track","stop","getBoundingClientRect","beforeDestroy","removeEventListener","watch","$nextTick","use","routes","path","Streamer","router","base","Store","state","mutations","actions","config","productionTip","store","render","App","$mount"],"mappings":"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","file":"js/app.4f651b8a.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/GMMKAmbilightChrome/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Streamer.vue?vue&type=style&index=0&id=41e906a8&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GSButton.vue?vue&type=style&index=0&id=81ad3996&scoped=true&lang=scss&\"","// copied and adapted from https://github.com/paulguy/gmmkctl\nimport _Vue from 'vue';\n\nexport const GMMK_CMD_START = 0x01;\nexport const GMMK_CMD_END = 0x02;\nexport const GMMK_CMD_KEYCOLORS = 0x11;\n\nexport const GMMK_CMD_SUBCOMMAND = 6;\nexport const GMMK_SUBCMD_CMD_OFFSET = 4;\nexport const GMMK_SUBCMD_ARG_OFFSET = 8;\n\nexport const GMMK_PACKET_SIZE = 64;\nexport const GMMK_COMMAND_OFFSET = 3;\nexport const GMMK_MAX_KEY = 126;\nexport const GMMK_SUM_OFFSET = 1;\n\nexport const GMMK_KEYCOLORS_COUNT_OFFSET = 4;\nexport const GMMK_KEYCOLORS_START_OFFSET = 5;\nexport const GMMK_KEYCOLORS_DATA_OFFSET = 8;\n// eslint-disable-next-line max-len\nexport const GMMK_KEYCOLORS_DATA_SIZE = Math.floor((GMMK_PACKET_SIZE - GMMK_KEYCOLORS_DATA_OFFSET) / 3) * 3;\n\nexport interface RGBColor {\n  r: number;\n  g: number;\n  b: number;\n}\n\nexport const fillSingleColor = (color: RGBColor, n: number): Array<RGBColor> => {\n  // bound n from 0 - Maxkeys\n  n = Math.min(GMMK_MAX_KEY, Math.max(n, 0));\n  return new Array(n).fill(color);\n};\n\n// stolen from GMMKUtil\n// I think the leading 4 is the report id\nconst dataSetProfile = [0x04, 0xdd, 0x03, 0x04, 0x2c, 0x00, 0x00, 0x00, 0x55, 0xaa, 0xff,\n  0x02, 0x45, 0x0c, 0x2f, 0x65, 0x00, 0x01, 0x00, 0x08, 0x00, 0x00,\n  0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x08, 0x07, 0x09,\n  0x0b, 0x0a, 0x0c, 0x0d, 0x0e, 0x0f, 0x10, 0x11, 0x12, 0x14, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\n  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00];\n\nexport class GMMKInterface {\n  HIDAvailable: boolean;\n\n  WebHID: HID;\n\n  selectedDevice?: HIDDevice | null;\n\n  buffer: Uint8Array;\n\n  colors: Array<RGBColor>;\n\n  initialized: boolean;\n\n  constructor() {\n    // check for HID compatibilty\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this.WebHID = (navigator as unknown as any).hid;\n    this.HIDAvailable = !!this.WebHID;\n    this.initialized = false;\n\n    this.buffer = new Uint8Array(GMMK_PACKET_SIZE);\n    this.colors = fillSingleColor({ r: 0xff, g: 0xff, b: 0xff }, GMMK_MAX_KEY);\n  }\n\n  async connectDevice() : Promise<boolean> {\n    // const supportedVIDs = [3141];\n\n    // reset the locally selected device:\n    this.selectedDevice = null;\n\n    const devices = await this.WebHID.requestDevice({\n      filters: [{\n        vendorId: 0x0C45,\n        productId: 0x652f,\n        // usage: 0x0f,\n        usagePage: 0xFF1C,\n      }],\n    });\n    console.log(devices);\n\n    if (devices.length === 0) return false;\n    [this.selectedDevice] = devices;\n\n    if (this.selectedDevice) return this.initializeKeyboard();\n    return false;\n  }\n\n  // TODO this has currently no error checking at all\n  // This means the init state inside the store is essentially meaningless.\n  async initializeKeyboard() : Promise<boolean> {\n    if (!this.selectedDevice) return false;\n    if (!this.selectedDevice.opened) await this.selectedDevice.open();\n    this.setProfile(1);\n    this.setCustomMode();\n    this.setRate(3);\n    this.setDelay(0);\n\n    this.setKeys(this.colors);\n\n    this.initialized = true;\n    return true;\n  }\n\n  resetBuffer(): void {\n    this.buffer.fill(0);\n  }\n\n  async setCustomMode(): Promise<void> {\n    await this.setMode(20);\n  }\n\n  async setMode(mode: number): Promise<void> {\n    this.resetBuffer();\n\n    this.buffer[GMMK_COMMAND_OFFSET] = GMMK_CMD_SUBCOMMAND;\n    this.buffer[GMMK_SUBCMD_CMD_OFFSET] = 0x01;\n    this.buffer[GMMK_SUBCMD_ARG_OFFSET] = mode;\n\n    // send data\n    await this.startCommand();\n    await this.write(this.buffer);\n    await this.endCommand();\n  }\n\n  // // Public\n  async setProfile(profile: 1 | 2 | 3): Promise<void> {\n    if (!this.selectedDevice) return;\n    // profile = Math.min(3, Math.max(1, profile));\n    const message = [...dataSetProfile];\n    message[18] = profile - 1;\n    await this.startCommand();\n    await this.write(new Uint8Array(message));\n    await this.endCommand();\n  }\n\n  async setDelay(delay: number): Promise<void> {\n    delay = Math.max(0, Math.min(delay, 0xff));\n    this.resetBuffer();\n\n    await this.startCommand();\n    this.buffer[GMMK_COMMAND_OFFSET] = GMMK_CMD_SUBCOMMAND;\n    this.buffer[GMMK_SUBCMD_CMD_OFFSET] = 0x01;\n    this.buffer[GMMK_SUBCMD_CMD_OFFSET + 1] = 0x02;\n    this.buffer[GMMK_SUBCMD_ARG_OFFSET] = delay;\n    await this.write(this.buffer);\n    await this.endCommand();\n  }\n\n  async setRate(rate: number): Promise<void> {\n    this.resetBuffer();\n\n    await this.startCommand();\n    this.buffer[GMMK_COMMAND_OFFSET] = GMMK_CMD_SUBCOMMAND;\n    this.buffer[GMMK_SUBCMD_CMD_OFFSET] = 0x01;\n    this.buffer[GMMK_SUBCMD_CMD_OFFSET + 1] = 0x0f;\n    this.buffer[GMMK_SUBCMD_ARG_OFFSET] = rate;\n    await this.write(this.buffer);\n    await this.endCommand();\n  }\n\n  // without tuning, this takes around 369.05ms for a full refresh\n  // buffer resets roughly take an additional 9ms\n  async setKeys(colors: Array<RGBColor>): Promise<void> {\n    if (!this.initialized) return;\n    const start = 0;\n    const count = colors.length;\n    // console.time('rgbkbdwrite');\n    await this.startCommand();\n\n    // const keysPerTransfer = Math.floor(GMMK_KEYCOLORS_DATA_SIZE/3)\n    // this.resetBuffer();\n    for (let i = 0; i < count;) {\n      // this.buffer[0] = 0x04;\n      this.buffer[GMMK_COMMAND_OFFSET] = GMMK_CMD_KEYCOLORS;\n      this.buffer[GMMK_KEYCOLORS_COUNT_OFFSET] = ((count - i) * 3 > GMMK_KEYCOLORS_DATA_SIZE)\n        ? GMMK_KEYCOLORS_DATA_SIZE : (count - i) * 3;\n      const bytesRemaining = (count - i) * 3;\n      // console.log(`${bytesRemaining} bytes still left to send`)\n      const bytesToBeSent = Math.min(GMMK_KEYCOLORS_DATA_SIZE, bytesRemaining);\n      const keysToBeSent = bytesToBeSent / 3;\n      this.buffer[GMMK_KEYCOLORS_COUNT_OFFSET] = bytesToBeSent;\n\n      // note that the offset actually get's bigger than 255\n      // so this is actually needed.\n      const offset = (start * 3) + (i * 3);\n      this.buffer[GMMK_KEYCOLORS_START_OFFSET] = offset & 0xff;\n      this.buffer[GMMK_KEYCOLORS_START_OFFSET + 1] = (offset >> 8);\n\n      // Format the data into the buffer to bve sent\n      for (let j = 0; j < bytesToBeSent; j += 3) {\n        // console.log(count, i, i + Math.floor(j/3))\n        this.buffer[GMMK_KEYCOLORS_DATA_OFFSET + j + 0] = colors[i + Math.floor(j / 3)].r;\n        this.buffer[GMMK_KEYCOLORS_DATA_OFFSET + j + 1] = colors[i + Math.floor(j / 3)].g;\n        this.buffer[GMMK_KEYCOLORS_DATA_OFFSET + j + 2] = colors[i + Math.floor(j / 3)].b;\n      }\n\n      // eslint-disable-next-line no-await-in-loop\n      await this.write(this.buffer);\n      i += keysToBeSent;\n      // console.log(`${bytesToBeSent} bytes sent ->\n      // ${bytesToBeSent / 3} keys | ${count - i} remaining`);\n    }\n    await this.endCommand();\n    // console.timeEnd('rgbkbdwrite');\n  }\n\n  // // private\n\n  // uses the variant from GMMK util, for now.\n\n  async startCommand(): Promise<void> {\n    // this.resetBuffer();\n    this.buffer[GMMK_COMMAND_OFFSET] = GMMK_CMD_START;\n    await this.write(this.buffer);\n  }\n\n  // // uses the variant from GMMK util, for now.\n  async endCommand(): Promise<void> {\n    // this.resetBuffer();\n    this.buffer[GMMK_COMMAND_OFFSET] = GMMK_CMD_END;\n    await this.write(this.buffer);\n  }\n\n  async write(buffer: Uint8Array): Promise<void> {\n    if (!this.selectedDevice) return;\n\n    // console.log('____')\n    // console.log('Before Checksum')\n    // console.log(buffer)\n    buffer[0] = 0x04;\n    const sum = buffer.slice(GMMK_COMMAND_OFFSET).reduce((acc, e) => acc + e) & 0xffff;\n    buffer[GMMK_SUM_OFFSET] = sum & 0xff;\n    buffer[GMMK_SUM_OFFSET + 1] = (sum >> 8) & 0xff;\n    // console.log('After Checksum')\n    // console.log(buffer)\n    // console.log('____')\n    await this.selectedDevice.sendReport(0x04, buffer.slice(1));\n  }\n}\n\n// export type PluginFunction<T> = (Vue: typeof _Vue, options?: T) => void;\nexport function GMMKPlugin(Vue: typeof _Vue): void {\n  // eslint-disable-next-line no-param-reassign\n  Vue.prototype.$gmmkInterface = new GMMKInterface();\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('RouterView')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=7cbf06fe&lang=pug&\"\nvar script = {}\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/* eslint-disable no-console */\n\nimport { register } from 'register-service-worker';\n\nif (process.env.NODE_ENV === 'production') {\n  register(`${process.env.BASE_URL}service-worker.js`, {\n    ready() {\n      console.log(\n        'App is being served from cache by a service worker.\\n'\n        + 'For more details, visit https://goo.gl/AFskqB',\n      );\n    },\n    registered() {\n      console.log('Service worker has been registered.');\n    },\n    cached() {\n      console.log('Content has been cached for offline use.');\n    },\n    updatefound() {\n      console.log('New content is downloading.');\n    },\n    updated() {\n      console.log('New content is available; please refresh.');\n    },\n    offline() {\n      console.log('No internet connection found. App is running in offline mode.');\n    },\n    error(error) {\n      console.error('Error during service worker registration:', error);\n    },\n  });\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"streamer-wrapper\"},[_c('div',{staticClass:\"info-wrapper\",class:_vm.showPreview? 'hidden' : ''},[_c('h1',[_vm._v(\"GMMK Ambilight\")]),_c('h2',[_vm._v(\"A WebHID experiment\")]),_vm._m(0)]),(!_vm.hasWebHIDSupport)?_c('div',{staticClass:\"info-wrapper\"},[_c('h1',[_vm._v(\"!! Please use Chrome, currently WebHID is not supported on other browsers. !!\")])]):_vm._e(),(_vm.hasWebHIDSupport)?_c('div',{staticClass:\"setup-wrapper\"},[(!_vm.showPreview)?_c('GSButton',{attrs:{\"text\":\"Select keyboard\"},on:{\"click\":_vm.selectHIDDevice},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('KeyboardIcon',{attrs:{\"size\":48}})]},proxy:true}],null,false,1681958304)}):_vm._e(),(!_vm.showPreview)?_c('GSButton',{attrs:{\"text\":\"Select Screen\",\"disabled\":_vm.sourceSelectButtonDisabled},on:{\"click\":_vm.selectDesktopSource},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('DisplayShareIcon',{attrs:{\"size\":48}})]},proxy:true}],null,false,3924833018)}):_vm._e(),(_vm.displayStreamStarted)?_c('GSButton',{attrs:{\"text\":\"Stop Stream\"},on:{\"click\":_vm.stopStream},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('StopIcon',{attrs:{\"size\":48}})]},proxy:true}],null,false,788270261)}):_vm._e(),(_vm.displayStreamStarted)?_c('GSButton',{attrs:{\"text\":\"Toggle Keyboard preview\"},on:{\"click\":_vm.toggleKeyboardPreview},scopedSlots:_vm._u([{key:\"icon\",fn:function(){return [_c('ShowKeyboardPreviewIcon',{attrs:{\"size\":48}})]},proxy:true}],null,false,2316924937)}):_vm._e()],1):_vm._e(),_c('div',{staticClass:\"video-container\",class:_vm.showPreview? '' : 'hidden'},[_c('div',{staticClass:\"preview-element\"},[_c('h1',[_vm._v(\"Input Video Preview\")]),_c('video',{ref:\"videoPreview\"})]),_c('div',{staticClass:\"preview-element\"},[_c('h1',[_vm._v(\"Keyboard output\")]),_c('div',{staticClass:\"canvas-wrapper\"},[_c('canvas',{ref:\"previewCanvas\"}),(_vm.showKeyPreview)?_c('div',{staticClass:\"overlay\"}):_vm._e(),_vm._l((_vm.keyMatrix.flat()),function(key){return (_vm.showKeyPreview)?_c('div',{staticClass:\"key-preview\",style:(_vm.keyStyles.get(key.keyIndex))},[_c('div',{staticClass:\"text\"},[_vm._v(_vm._s(key.label))])]):_vm._e()})],2)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"text-wrapper\"},[_c('span',[_vm._v(\"Under the hood a hacky combination of DesktopStreaming is used with the\")]),_c('b',[_vm._v(\"amazing\")]),_c('span',[_vm._v(\"WebHID interface, to communicate directly from the browser to the Keyboard.\")]),_c('span',[_vm._v(\"This works best (and I think only) on Chrome.\")]),_c('span',[_vm._v(\"And with a GMMK keyboard (Maybe others work too?).\")]),_c('span',[_vm._v(\"This project's HID code is\")]),_c('span',{staticClass:\"crossed\"},[_vm._v(\"stolen\")]),_c('span',[_vm._v(\"heavily inspired by multiple other projects -\")]),_c('span',[_vm._v(\"most notably\")]),_c('a',{attrs:{\"href\":\"https://github.com/paulguy/gmmkctl\"}},[_vm._v(\"gmmkctl\")]),_c('span',[_vm._v(\"and\")]),_c('a',{attrs:{\"href\":\"https://github.com/dokutan/rgb_keyboard\"}},[_vm._v(\"rgb_keyboard\")]),_c('span',[_vm._v(\"- definitely check them out, they're very cool projects and without them\")]),_c('span',[_vm._v(\"this little experiment would not exist.\")]),_c('br'),_c('br'),_c('span',[_vm._v(\"But enough information - let's get to the cool stuff!\")]),_c('br'),_c('span',[_vm._v(\"To get started, simply select your keyboard and video input.\")])])}]\n\nexport { render, staticRenderFns }","export const gcd = (a: number, b: number): number => {\n  if (b === 0) return a;\n  return gcd(b, a % b);\n};\n\nexport const lcm = (a: number, b: number): number => (Math.abs(a) / gcd(a, b)) * Math.abs(b);\n\nexport const minMultF2I = (num: number): number => {\n  const nstr = num.toString(10);\n  const ndecimal = nstr.split('.')[1]?.length ?? 0;\n  if (ndecimal === 0) return 1;\n  const fractionDenominator = 10 ** ndecimal;\n  return fractionDenominator / gcd(num * fractionDenominator, fractionDenominator);\n};\n\nexport const deduplicateArray = <T>(array: Array<T>): Array<T> => {\n  const deduped: Array<T> = [];\n  // eslint-disable-next-line no-restricted-syntax\n  for (const el of array) {\n    // eslint-disable-next-line no-continue\n    if (deduped.includes(el)) continue;\n    deduped.push(el);\n  }\n  return deduped;\n};\n\nexport const linspace = (a: number, b: number, n: number): Array<number> => {\n  const step = (b - a) / (n - 1);\n  return new Array(n).fill(1).map((e, i) => a + (i) * step);\n};\n\nexport const gaussian = (x: number, mu = 0, sigma = 0.01): number => {\n  const a = 1 / (sigma * Math.sqrt(2 * Math.PI));\n  return (a * Math.exp(-0.5 * ((x ** 2 - mu ** 2) / sigma ** 2)));\n};\n","export default \"ES    F1  F2  F3  F4    F5  F6  F7  F8    F9  F10 F11 F12  Druck  Roll  Pause/Unterbr\\n1     2   3   4   5     6   7   8   9     10  11  12  13   107   108   \\t\\t109\\n^   1   2   3   4   5   6   7   8   9   0   ß   ´   BKSP   EIN POS1 PU   NL  /   *   -\\n19  20  21  22  23  24  25  26  27  28  29  30  31  99     111 112 113  32  33  34  117\\nTAB  Q   W   E   R   T   Z   U   I   O   P   Ü   +   ENTER   ENT END  PD   7   8   9  +\\n36   37  38  39  40  41  42  43  44  45  46  47  48   82    114 115 116  49  50  51  118\\nCAPS  A   S   D   F   G   H   J   K   L   Ö   Ä                            4   5   6\\n53    54  55  56  57  58  59  60  61  62  63  64                          65  66  67\\nLSHIFT <|>    Y   X   C   V   B   N   M   ,   .   -    RSHIFT       UP     1   2   3    KE\\n70     106   71  72  73  74  75  76  77  78  79  80   81           97       83  84  85 102\\nSTRG  SUP  ALT         SPACE         ALT  Fn  MNU  STRG    LE  DN  RI   0       .   \\n87    88   89          90            91   92   93   94     95  96  98   100    101 \\n\";","import { lcm, minMultF2I, deduplicateArray } from '@/lib/utils';\n\n/* eslint-disable */\n\nimport QMK_ISO_KEYMATRIX from '@/assets/oem_iso_fullsize.json';\nimport QMK_ISO_KEYMAP from '@/assets/iso_fullsize_default_layout.json';\n\nimport GMMK_ISO_MAP from '!raw-loader!@/assets/keymap-DE-ISO-fullsize.txt';\n\n// Mathematical helpers\n\n// converts the given float into the smallest integer without loss of precision\n// const F2I_swl = (num) => {\n//   return minMultF2I(num) * num;\n// }\n\n\n/* Interfaces */\ninterface SimpleKeyboardMapElement {\n  keyIndex: number;\n}\n\ninterface SimpleKeyboardMap extends Array<Array<SimpleKeyboardMapElement>> {\n  shape?: Array<number>;\n};\n\ninterface QMKKey { \n  x: number;\n  y:number;\n  w?: number;\n  h?: number;\n  label: string;\n}\n\ninterface QMKKeyboardDescriptor {\n  git_hash: string;\n  keyboards: {\n    [key: string]: {\n      keyboard_name: string;\n      layouts: { \n        [key: string]: {\n          key_count: number;\n          layout: Array<{x: number, y:number, w?: number, h?: number, label: string}>;\n        }\n      }\n    }\n  }\n  last_updated: string;\n}\n\ninterface QMKKeyboardMap {\n  commit: string;\n  keyboard: string;\n  keymap: string;\n  layers: Array<Array<String>>;\n}\n\nexport interface MappedKey {\n  x: number;\n  y:number;\n  w: number;\n  h: number;\n  label: string;\n\n  keyIndex: number;\n\n  center: {\n    x: number;\n    y: number;\n  }\n}\n\nexport interface KeyboardMatrix extends Array<Array<MappedKey>> {\n  shape?: Array<number>;\n  boundingBox?: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  };\n}\n\nconst getKeyboardMapfromQMKJson = (descriptor: QMKKeyboardDescriptor, map: QMKKeyboardMap): Array<QMKKey> => {\n  const kbdName = map.keyboard;\n\n  const { keyboards } = descriptor;\n  const { layouts } = keyboards[kbdName];\n  const layout_names = Object.keys(layouts);\n\n  return layouts[layout_names[0]].layout.map((e: any, i: number) => {\n    // Override the label with the defaults, for debugging.\n    const label = map.layers[0][i];\n    return { ...e, label };\n  });\n};\n\nconst matrixifyQMK = (qmkLayout: Array<QMKKey>): Array<Array<QMKKey>> => {\n  const yValues = deduplicateArray(qmkLayout.map((e) => e.y));\n  // const xValues = deduplicateArray(simplifiedLayout.map(e => e.x));\n\n  const qmkMatrix = yValues.map((y, y_index) => qmkLayout\n    .filter((e: any) => e.y === y)\n    .map((e: any, x_index: any) => ({ x_index, y_index, ...e })));\n  return qmkMatrix;\n};\n\n\nconst parseTextKeyboardMap = (map: string): SimpleKeyboardMap => {\n  const elements = map.split('\\n')\n    .map((row: any) => row.split(/\\s+/).filter((element: string) => !!element))\n    .filter((e: any) => !!e.length);\n\n  // We actually only care about the index-rows\n  const index_rows = elements.filter((e, i) => i % 2 === 1);\n  const kbdMap: SimpleKeyboardMap  = [];\n\n  const mapWidth = Math.max(...index_rows.map((e) => e.length));\n  const mapHeight = index_rows.length;\n\n  // console.log(`Your keyboard essentially is a wonky ${size_x}x${size_y} monitor :)`)\n  for (let y = 0; y < mapHeight; y++) {\n    const row = [];\n    for (let x = 0; x < mapWidth; x++) {\n      const keyIndex = (index_rows[y].length > x) ? parseInt(index_rows[y][x]) : -1;\n      row.push({ keyIndex });\n    }\n    kbdMap.push(row);\n  }\n\n  kbdMap.shape = [mapHeight, mapWidth];\n\n  return kbdMap;\n}\n\nexport const generateMap = () => {\n  // console.log('mapping...');\n\n  // While the pure GMMK ISO map gives us a rough estimated where the keys are\n  // This cannot be used for proper graphics.\n  // Since the keys are not simply linearly spaced in x and y.\n\n  // First the GMMK map is used to get key a key-position matrix\n  // This is used with the ISO OEM map to get the actual positions\n\n  // Which then can be used to generat a bitmap and a key-mapping for that bitmap :)\n\n  // Load and matrixify the gmmk keymap\n  const gmmk_keymap = parseTextKeyboardMap(GMMK_ISO_MAP);\n\n  // load and matrxify the corresponding QMK keymap\n  const qmk_layout = getKeyboardMapfromQMKJson(QMK_ISO_KEYMATRIX, QMK_ISO_KEYMAP);\n  const qmkMatrix = matrixifyQMK(qmk_layout);\n\n  // match up the matrixes\n  const combinedMatrix: KeyboardMatrix = [];\n  if (!gmmk_keymap.shape) return;\n  for (let y = 0; y < gmmk_keymap.shape[0]; y++) {\n    const combined_row = [];\n    for (let x = 0; x < gmmk_keymap.shape[1]; x++) {\n      const { keyIndex } = gmmk_keymap[y][x];\n      const qmkElement = qmkMatrix[y][x];\n      const qmkMapperExists = !!qmkElement;\n\n      const key_x = (qmkMapperExists) ? qmkElement.x : -1;\n      const key_y = (qmkMapperExists) ? qmkElement.y : -1;\n      const key_w = (qmkMapperExists) ? qmkElement.w ?? 1 : -1;\n      const key_h = (qmkMapperExists) ? qmkElement.h ?? 1 : -1;\n      const label = (qmkMapperExists) ? qmkElement.label : '';\n\n      const center = { x: key_x + (key_w / 2), y: key_y + (key_h / 2) };\n\n      const keyInfo = {\n        x: key_x, y: key_y, w: key_w, h: key_h, label, keyIndex, center,\n      };\n      combined_row.push(keyInfo);\n    }\n    combinedMatrix.push(combined_row);\n  }\n\n  combinedMatrix.shape = gmmk_keymap.shape;\n\n\n  // since we know all the keys sizes (w & h) and positions\n\n  const tmpMap = combinedMatrix.flat();\n\n  // calculate the keyboard's bounding-box.\n  const min_x = Math.min(...tmpMap.map((e) => e.x));\n  const max_x = Math.max(...tmpMap.map((e) => e.x + e.w));\n\n  const min_y = Math.min(...tmpMap.map((e) => e.y));\n  const max_y = Math.max(...tmpMap.map((e) => e.y + e.h));\n\n  const bitmap_scl_x = lcm(minMultF2I(min_x), minMultF2I(max_x));\n  const bitmap_scl_y = lcm(minMultF2I(min_y), minMultF2I(max_y));\n  const kbdBitmapSize = {\n    x: (max_x - min_x) * bitmap_scl_x, y: (max_y - min_y) * bitmap_scl_y, bitmap_scl_x, bitmap_scl_y,\n  };\n\n  combinedMatrix.boundingBox = {\n    x: min_x,\n    y: min_y,\n    width: max_x - min_x,\n    height: max_y - min_y\n  }\n\n  // console.log(allKeys)\n  return {\n    combinedMatrix, kbdBitmapSize\n  };\n};\n","// WebGL helpers\nexport const createShader = (gl: WebGLRenderingContext, source: string, type: 'frag' | 'vert'): WebGLShader | null => {\n  let shaderType;\n  switch (type) {\n    case 'frag':\n      shaderType = gl.FRAGMENT_SHADER;\n      break;\n    default:\n    case 'vert':\n      shaderType = gl.VERTEX_SHADER;\n      break;\n  }\n\n  const shader = gl.createShader(shaderType);\n  if (!shader) return null;\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n\n  const compileMsg = gl.getShaderInfoLog(shader);\n  if (compileMsg) console.log(`${type} shader compiled with error: ${compileMsg}`);\n\n  return shader;\n};\n\n// eslint-disable-next-line max-len\nexport const createTexture = (gl: WebGLRenderingContext, size: { offsetWidth: number, offsetHeight: number}) : WebGLTexture | null => {\n  const texture = gl.createTexture();\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, size.offsetWidth,\n    size.offsetHeight, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n  return texture;\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"gsbutton\",class:_vm.disabled? 'disabled' : '',on:{\"click\":_vm.onClick}},[_vm._t(\"icon\"),_c('div',{staticClass:\"text\"},[_vm._v(_vm._s(_vm.text))])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\nimport { Vue } from 'vue-property-decorator';\n\nexport default Vue.extend({\n  name: 'GSButton',\n  props: {\n    text: {\n      type: String,\n      default: '',\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  methods: {\n    onClick() {\n      if (!this.disabled) this.$emit('click');\n    },\n  },\n});\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GSButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GSButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./GSButton.vue?vue&type=template&id=81ad3996&scoped=true&lang=pug&\"\nimport script from \"./GSButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./GSButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./GSButton.vue?vue&type=style&index=0&id=81ad3996&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"81ad3996\",\n  null\n  \n)\n\nexport default component.exports","export default \"\\r\\nprecision mediump float;\\r\\nvarying vec2 uv;\\r\\n\\r\\nuniform sampler2D uSampler;\\r\\nuniform vec2 resolution;\\r\\n\\r\\nuniform float kernel[16];\\r\\n\\r\\nconst int size = 16;\\r\\n\\r\\nvoid main(void) {\\r\\n  vec2 step = 1.0/resolution;\\r\\n  vec4 color = vec4(0.0);\\r\\n\\r\\n  float kernel_mag = 0.0;\\r\\n\\r\\n  for(int x=0; x < size; x +=1) {\\r\\n    for(int y=0; y < size; y +=1) {\\r\\n      vec2 offset = vec2(float(x), float(y)) - vec2(float(size) / 2.0);\\r\\n      float kernel_val = kernel[x] * kernel[y];\\r\\n      kernel_mag += kernel_val;\\r\\n      color += kernel_val * texture2D(uSampler, uv + offset*step);\\r\\n    }\\r\\n  }\\r\\n\\r\\n  color /= kernel_mag;\\r\\n\\r\\n  gl_FragColor = color;\\r\\n}\";","export default \"attribute vec2 coordinates;\\r\\nattribute vec2 uv_coordinates;\\r\\n\\r\\nvarying vec2 uv;\\r\\n\\r\\nvoid main(void) {\\r\\n\\t// uv = tex;\\r\\n\\t// gl_Position = vec4(vec3(x, 1) * view, 1);\\r\\n  gl_Position = vec4(coordinates, 0.0, 1.0);\\r\\n  uv = uv_coordinates;\\r\\n}\";","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Vue } from 'vue-property-decorator';\nimport { generateMap, MappedKey } from '@/lib/libMap';\n\nimport { createShader, createTexture } from '@/lib/libGL';\nimport { gaussian, linspace } from '@/lib/utils';\n\nimport { GMMK_MAX_KEY } from '@/plugins/GMMKPlugin';\n\nimport KeyboardIcon from 'vue-material-design-icons/KeyboardSettings.vue';\nimport DisplayShareIcon from 'vue-material-design-icons/MonitorShare.vue';\nimport StopIcon from 'vue-material-design-icons/Stop.vue';\nimport ShowKeyboardPreviewIcon from 'vue-material-design-icons/CardSearchOutline.vue';\nimport GSButton from '@/components/GSButton.vue';\n\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport blurFragShader from '!raw-loader!@/shaders/blur.frag';\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport blurVertShader from '!raw-loader!@/shaders/blur.vert';\n\n// Icons\n\n// Custom components\n\ninterface HomeData {\n  desktopMediaStream: MediaStream | null;\n\n  gl: WebGLRenderingContext | null;\n  glInitialized: boolean;\n  shaderProgram: WebGLProgram | null;\n\n  kbdBitmapSize: any;\n  keyMatrix: any;\n  canvasResolution: Array<number>;\n\n  sigma: number;\n  isStreaming: boolean;\n\n  pixelBuffer: Uint8Array | null;\n\n  // State:\n  keyboardInitialized: boolean;\n  displayStreamStarted: boolean;\n\n  showKeyPreview: boolean;\n\n  canvasSize: { width: number, height: number };\n\n  hasWebHIDSupport: boolean;\n}\n\nexport default Vue.extend({\n  data() : HomeData {\n    return {\n      desktopMediaStream: null,\n      gl: null,\n      glInitialized: false,\n      shaderProgram: null,\n\n      kbdBitmapSize: null,\n      keyMatrix: [],\n      canvasResolution: [0, 0],\n\n      sigma: 0.1,\n      isStreaming: true,\n      pixelBuffer: null,\n\n      // UI State\n      keyboardInitialized: false,\n      displayStreamStarted: false,\n      showKeyPreview: false,\n      canvasSize: { width: 0, height: 0 },\n      hasWebHIDSupport: false,\n    };\n  },\n  components: {\n    KeyboardIcon,\n    GSButton,\n    DisplayShareIcon,\n    ShowKeyboardPreviewIcon,\n    StopIcon,\n  },\n  mounted() {\n    this.hasWebHIDSupport = this.$gmmkInterface.HIDAvailable;\n    const maps = generateMap();\n    this.kbdBitmapSize = maps?.kbdBitmapSize;\n    this.keyMatrix = maps?.combinedMatrix;\n\n    window.addEventListener('resize', this.resizeListener);\n  },\n\n  computed: {\n    sourceSelectButtonDisabled(): boolean {\n      if (!this.keyboardInitialized) return true;\n      return this.displayStreamStarted;\n    },\n\n    showPreview(): boolean {\n      return this.keyboardInitialized && this.displayStreamStarted;\n    },\n\n    keyStyles(): Map<number, any> {\n      return new Map(this.keyMatrix.flat().map((key: MappedKey) => {\n        const { width, height } = this.canvasSize;\n        const capSize = Math.min(width / this.keyMatrix.boundingBox.width,\n          height / this.keyMatrix.boundingBox.height);\n\n        return [key.keyIndex, {\n          position: 'absolute',\n          left: `${key.x * capSize}px`,\n          top: `${key.y * capSize}px`,\n          width: `${key.w * capSize}px`,\n          height: `${key.h * capSize}px`,\n        }];\n      }));\n    },\n  },\n  methods: {\n    async selectHIDDevice(): Promise<void> {\n      const result = await this.$gmmkInterface.connectDevice();\n      this.keyboardInitialized = result;\n    },\n\n    async selectDesktopSource(): Promise<void> {\n      const screen = await (navigator.mediaDevices as any)\n        .getDisplayMedia({ audio: false, video: true });\n      this.desktopMediaStream = screen;\n\n      if (this.desktopMediaStream) {\n        const videoPreview = this.$refs.videoPreview as HTMLVideoElement;\n        videoPreview.srcObject = this.desktopMediaStream;\n        videoPreview.onloadedmetadata = () => {\n          videoPreview.play();\n          this.displayStreamStarted = true;\n          setTimeout(this.initStreamer, 0);\n        };\n\n        this.desktopMediaStream.getVideoTracks()[0].addEventListener('ended', () => {\n          this.displayStreamStarted = false;\n        });\n      }\n    },\n\n    initStreamer(): void {\n      this.init_webGL();\n      setTimeout(this.webgl_process_frame, 100);\n    },\n\n    init_webGL(): void {\n      const video = this.$refs.videoPreview as HTMLVideoElement;\n      if (!this.gl) {\n        const canvas = this.$refs.previewCanvas as HTMLCanvasElement;\n        canvas.width = this.kbdBitmapSize.x;\n        canvas.height = this.kbdBitmapSize.y;\n\n        this.canvasResolution = [canvas.width, canvas.height];\n        this.gl = canvas.getContext('webgl', { preserveDrawingBuffer: true });\n      }\n      const { gl } = this;\n      if (!gl) return;\n\n      const vertexShader = createShader(gl, blurVertShader, 'vert');\n      const fragmentShader = createShader(gl, blurFragShader, 'frag');\n      if (!vertexShader || !fragmentShader) return;\n\n      this.shaderProgram = gl.createProgram();\n      if (!this.shaderProgram) return;\n      gl.attachShader(this.shaderProgram, vertexShader);\n      gl.attachShader(this.shaderProgram, fragmentShader);\n      gl.linkProgram(this.shaderProgram);\n\n      /*= ========= Defining and storing the geometry ========= */\n\n      const vertexArray = new Float32Array([\n        -1, 1,\n        -1, -1,\n        1, -1,\n        1, 1,\n      ]);\n\n      const uv = new Float32Array([\n        0, 0,\n        0, 1,\n        1, 1,\n        1, 0,\n      ]);\n\n      const indices = [3, 2, 1, 3, 1, 0];\n      const shaderProgram = this.shaderProgram as any;\n      shaderProgram.nIndices = indices.length;\n\n      // Create an empty buffer object to store vertex buffer\n      shaderProgram.vertexBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, shaderProgram.vertexBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, vertexArray, gl.STATIC_DRAW);\n\n      // Create UV Buffer\n      shaderProgram.UVBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ARRAY_BUFFER, shaderProgram.UVBuffer);\n      gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(uv), gl.STATIC_DRAW);\n\n      // Create an empty buffer object to store Index buffer\n      shaderProgram.IndexBuffer = gl.createBuffer();\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, shaderProgram.IndexBuffer);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);\n\n      // create video texture:\n      shaderProgram.videoTexture = createTexture(gl, video);\n    },\n\n    // GL Post-processing\n    webgl_process_frame(): void {\n      console.log('processing webgl frame');\n      const video = this.$refs.videoPreview as HTMLVideoElement;\n      const canvas = this.$refs.previewCanvas as HTMLCanvasElement;\n      if (!this.gl) this.init_webGL();\n      const { gl } = this;\n      if (!gl) return;\n      gl.useProgram(this.shaderProgram);\n\n      /* ======= Associating shaders to buffer objects ======= */\n\n      const shaderProgram = this.shaderProgram as any;\n\n      // Bind vertex buffer object\n      gl.bindBuffer(gl.ARRAY_BUFFER, shaderProgram.vertexBuffer);\n      const vertexBufferCoord = gl.getAttribLocation(shaderProgram, 'coordinates');\n      gl.vertexAttribPointer(vertexBufferCoord, 2, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(vertexBufferCoord);\n\n      // Bind uv buffer object\n      gl.bindBuffer(gl.ARRAY_BUFFER, shaderProgram.UVBuffer);\n      const uvBufferCoord = gl.getAttribLocation(shaderProgram, 'uv_coordinates');\n      gl.vertexAttribPointer(uvBufferCoord, 2, gl.FLOAT, false, 0, 0);\n      gl.enableVertexAttribArray(uvBufferCoord);\n\n      // Bind index buffer object\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, shaderProgram.IndexBuffer);\n\n      // Bind the texture:\n      // Tell WebGL we want to affect texture unit 0\n      gl.uniform1i(gl.getUniformLocation(shaderProgram, 'uSampler'), 0);\n      gl.activeTexture(gl.TEXTURE0);\n      gl.bindTexture(gl.TEXTURE_2D, shaderProgram.videoTexture);\n      try {\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, video as any);\n      } catch (error) {\n        setTimeout(this.webgl_process_frame, 100);\n        return;\n      }\n\n      // bind the resolution uniform:\n      gl.uniform2f(gl.getUniformLocation(shaderProgram, 'resolution'), this.canvasResolution[0], this.canvasResolution[1]);\n\n      // construct gaussian kernel\n\n      const kernelSize = 16;\n      const { sigma } = this;\n      const kernel = linspace(-1, 1, kernelSize)\n        .map((x) => gaussian(x, 0, sigma));\n\n      gl.uniform1fv(gl.getUniformLocation(shaderProgram, 'kernel'), kernel);\n\n      /*= ============ Drawing the Quad ================ */\n\n      // Clear the canvas\n      gl.clearColor(0.5, 0.5, 0.5, 1.0);\n      // gl.enable(gl.DEPTH_TEST);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n      gl.viewport(0, 0, canvas.width, canvas.height);\n      gl.drawElements(gl.TRIANGLES, shaderProgram.nIndices, gl.UNSIGNED_SHORT, 0);\n      gl.flush();\n\n      setTimeout(this.download_image, 0);\n    },\n\n    // image -> kbd interface:\n    async download_image(): Promise<void> {\n      // console.log('downloading frame');\n      const { gl } = this;\n      if (!gl) return;\n      // console.log(`GL Framebuffer size: ${gl.drawingBufferWidth} x ${gl.drawingBufferHeight}`);\n      // console.log(`That's : ${gl.drawingBufferWidth * gl.drawingBufferHeight * 4} elements`);\n\n      if (!this.pixelBuffer) {\n        this.pixelBuffer = new Uint8Array(gl.drawingBufferWidth * gl.drawingBufferHeight * 4);\n      }\n\n      gl.readPixels(0, 0, gl.drawingBufferWidth,\n        gl.drawingBufferHeight, gl.RGBA, gl.UNSIGNED_BYTE, this.pixelBuffer);\n      const keyColors = new Array(GMMK_MAX_KEY).fill({ r: 0, g: 0, b: 0 });\n\n      const [sy, sx] = this.keyMatrix.shape;\n      // const sx = this.keyMatrix[0].length;\n\n      const [canvasWidth, canvasHeight] = this.canvasResolution;\n      const stepX = canvasWidth / sx;\n      const stepY = canvasHeight / sy;\n\n      for (let y = 0; y < sy; y += 1) {\n        for (let x = 0; x < sx; x += 1) {\n          const { keyIndex, center } = this.keyMatrix[y][x];\n          // eslint-disable-next-line no-continue\n          if (keyIndex === -1) continue;\n          const px = Math.floor(center.x * stepX);\n          const py = Math.floor(center.y * stepY);\n\n          // console.log(px, py, keyIndex);\n          const idx = (px + (py * gl.drawingBufferWidth)) * 4;\n\n          keyColors[keyIndex - 1] = {\n            r: this.pixelBuffer[idx],\n            g: this.pixelBuffer[idx + 1],\n            b: this.pixelBuffer[idx + 2],\n          };\n        }\n      }\n      // console.log(this.pixelBuffer);\n      // console.log(keyColors);\n      await this.$gmmkInterface.setKeys(keyColors);\n\n      // request next frame:\n      // this.renderInterval = setTimeout(this.)\n      if (this.isStreaming) setTimeout(this.webgl_process_frame, 500);\n      // else this.shutdown();\n    },\n\n    // Stream control\n    stopStream(): void {\n      // if the stream was open, close it properly\n      if (this.desktopMediaStream) {\n        this.desktopMediaStream.getTracks()\n          .forEach((track: MediaStreamTrack) => track.stop());\n      }\n      this.isStreaming = false;\n      this.desktopMediaStream = null;\n      this.displayStreamStarted = false;\n    },\n\n    toggleKeyboardPreview(): void {\n      this.showKeyPreview = !this.showKeyPreview;\n    },\n\n    resizeListener(): void {\n      if (!this.$refs.previewCanvas) return;\n      const { width, height } = (this.$refs.previewCanvas as HTMLElement).getBoundingClientRect();\n      this.canvasSize = { width, height };\n    },\n  },\n\n  beforeDestroy() {\n    this.stopStream();\n    window.removeEventListener('resize', this.resizeListener);\n  },\n\n  watch: {\n    showPreview() {\n      this.$nextTick(this.resizeListener);\n    },\n  },\n\n});\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Streamer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Streamer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Streamer.vue?vue&type=template&id=41e906a8&scoped=true&lang=pug&\"\nimport script from \"./Streamer.vue?vue&type=script&lang=ts&\"\nexport * from \"./Streamer.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./Streamer.vue?vue&type=style&index=0&id=41e906a8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"41e906a8\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue';\nimport VueRouter, { RouteConfig } from 'vue-router';\nimport Streamer from '../views/Streamer.vue';\n\nVue.use(VueRouter);\n\nconst routes: Array<RouteConfig> = [\n  {\n    path: '/',\n    name: 'Streamer',\n    component: Streamer,\n  },\n];\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes,\n});\n\nexport default router;\n","import Vue from 'vue';\nimport Vuex from 'vuex';\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n  },\n  mutations: {\n  },\n  actions: {\n  },\n  modules: {\n  },\n});\n","import Vue from 'vue';\nimport { GMMKPlugin } from '@/plugins/GMMKPlugin';\nimport { ReactiveRefs } from 'vue-reactive-refs';\n\nimport App from './App.vue';\nimport './registerServiceWorker';\nimport router from './router';\nimport store from './store';\n\nVue.config.productionTip = false;\nVue.use(GMMKPlugin);\nVue.use(ReactiveRefs);\n\nnew Vue({\n  router,\n  store,\n  render: (h) => h(App),\n}).$mount('#app');\n"],"sourceRoot":""}